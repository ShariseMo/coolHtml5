<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
	<title>E购宝终端管理后台登陆</title>
	<link rel="stylesheet" href="./style/init.css">
	<link rel="stylesheet" href="./style/login.css">
</head>
<body>
	<div class="content_box">
		<div class="login_box">
			<img class="logo_img" src="./image/login_logo.png" alt="">
			<div class="login_form">
				<p class="loginTips">
					请用店小二后台管理员账号登陆
				</p>
				<div class="input_group">
					<label for="account">用户名:</label>
					<input type="text" placeholder="请通过店小二后台管理员账号登陆." v-model="account" id="account">
				</div>
				
				<div class="input_group">
					<label for="pwd">密&nbsp;&nbsp;&nbsp;码&nbsp;:</label>
					<input type="password" v-model="pwd" id="pwd">
				</div>
				<p id="notice"></p>
				<div class="input_group">
					<!-- <input type="checkbox" id="remenber_pwd">
					<label for="remenber_pwd" placeholder="passWordsword">记住密码</label> -->

					<a class="forgetPwd" href="http://msm.edsmall.cn/index/6" target="_blank" style="margin-left:80px;">忘记密码？</a>

				</div>
				<button class="login_btn" onClick="loginClick()" id="login_btn">登录</button>
			</div>
		</div>
		<div class="blue_box"></div>
		<div class="gray_box"></div>
	</div>
	<script type="text/javascript" src="js/jquery-2.1.4.min.js"></script>
	<script src="js/md5.js"></script>
	<!-- <script src="js/build.js"></script> -->
	<script>

	$('body').keydown(function(){
		if(event.keyCode == "13"){
			loginClick();
		}
	});

		function loginClick(){
		    var account = document.getElementById("account").value,
		    		pwd = document.getElementById("pwd").value;
		    login(account,pwd)
		};

		function login(account,pwd){
    	var	xhr = new XMLHttpRequest(),
    			loginData = {};

	    xhr.open("POST", "/login");
	    loginData.userName=account;
	    loginData.passWord=hex_md5(pwd);

      //记住密码
    	// if(document.getElementById("remenber_pwd").checked){
    	// 	loginData.remember=1;
    	// }

    	loginData = JSON.stringify(loginData)
    	console.log(loginData)
    	//设置请求头
    	xhr.setRequestHeader("Content-Type","application/json")

      xhr.send(loginData);

      xhr.onreadystatechange = function () {
            // 通信成功时，状态值为4
            var completed = 4;
            if (xhr.readyState === completed) {
                if (xhr.status === 200) {
                    // 处理服务器发送过来的数据
                    var result = JSON.parse(xhr.responseText);
                    console.log(result);
                    if(200==result.code){
                    	// document.cookie="username="+result.data.name;
                    	localStorage.setItem("username",result.data.name);
	                    location.href="/index.html";
                    }else{
                    	console.log(result);
                    	document.getElementById('notice').innerHTML = result.msg;
                    }
                    
                } else {// 处理错误
                    alert('连接超时');
                }
            }
        };
		}
		String.prototype.trim=function() {  
	    return this.replace(/(^\s*)|(\s*$)/g,'');  
	}; 
	</script>
</body>
</html>