<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<script type="text/javascript" src="./js/jquery-2.1.4.min.js"></script>
	<script type="text/javascript" src="./js/areaList.js"></script>
	<title>四级联动测试页面</title>
</head>
<body>
	<div>
		<form id="dataForm" name="dataForm" action="" method="post">
			<select class="province" name="province"></select>
			<select class="city" name="city"></select>
			<select class="district" name="district"></select>
			<select class="town" name="town"></select>
			<a href="#" onclick="save()">保存</a>
			<button>jjj</button>
		</form>
		
		<!-- 主页面 -->
		<!-- <a href="#" id="load_page" onclick="load_page()">加载新页面</a> -->
		<a href="#" id="load_page">加载新页面</a>
		<div id="new_page"></div>
		
	</div>

	<script type="text/javascript">


		// function load_page(){
		// 	$.ajax({
		// 		url:"load_page.html",
		// 		success:function(res){
		// 			$('#new_page').html(res);
		// 			console.log("加载页面成功！");
		// 		}
		// 	});
		// }

		$(function(){
			select();
			$('#load_page').click(function(){
				$('#new_page').load('load_page.html');
			});
		});

	

		function select(){
			var html = "<option>===请选择===</option>";
			$('.city').append(html);
			$('.district').append(html);
			$('.town').append(html);
			for(var i = 0;i<areaList.length;i++){
				var pp = areaList[i];
				html += "<option value='"+pp['code']+"' parentid='"+pp['parentId']+"'>"+pp['name']+"</option>";
			}
			$('.province').append(html);

			// console.log($('.province option').eq(0).attr('pid'));
			// console.log($('.province option')[0].value);
			$('.province').change(function(){
				if($(this).val()=="")  return;
				$('.city option').remove();
				$('.district option').remove();
				$('.town option').remove();
				var code = $(this).find('option:selected').val();
				var html = "<option>===请选择===</option>";
				for(var i = 0;i<areaList.length;i++){
					for(var j = 0;j<areaList[i]['subordinates'].length;j++){
						var cc = areaList[i]['subordinates'][j];
						if(cc['parentId'] == code){
							html += "<option value='"+cc['code']+"' parentid='"+cc['parentId']+"'>"+cc['name']+"</option>";
						}
					}
				}
				$('.city').append(html);
			});

			$('.city').change(function(){
				if($(this).val()=="") return;
				$('.district option').remove();
				$('.town option').remove();
				var code = $(this).find('option:selected').val();
				var html = "<option>===请选择===</option>";
				for(var i = 0;i<areaList.length;i++){
					for(var j = 0;j<areaList[i]['subordinates'].length;j++){
						for(var k = 0;k<areaList[i]['subordinates'][j]['subordinates'].length;k++){
							var dd = areaList[i]['subordinates'][j]['subordinates'][k];
							if(dd['parentId'] == code){
								html += "<option value='"+dd['code']+"' parentid='"+dd['parentId']+"'>"+dd['name']+"</option>";
							}
						}
					}
				}
				$('.district').append(html);
			});

			$('.district').change(function(){
				if($(this).val()=="") return;
				$('.town option').remove();
				var code = $(this).find('option:selected').val();
				var html = "<option>===请选择===</option>";
				for(var i = 0;i<areaList.length;i++){
					for(var j = 0;j<areaList[i]['subordinates'].length;j++){
						for(var k = 0;k<areaList[i]['subordinates'][j]['subordinates'].length;k++){
							for(var l = 0;l<areaList[i]['subordinates'][j]['subordinates'][k]['subordinates'].length;l++){
								var tt = areaList[i]['subordinates'][j]['subordinates'][k]['subordinates'][l];
								if(tt['parentId'] == code){
									html +=  "<option value='"+tt['code']+"' parentid='"+tt['parentId']+"'>"+tt['name']+"</option>";
								}
							}
						}
					}
				}
				$('.town').append(html);
			});
		}

		function save(){
			var data = $('#dataForm').serialize();
			console.log(data);
		}

	</script>
</body>
</html>