<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>E购宝管理后台</title>
	<link rel="stylesheet" type="text/css" href="./style/Font-Awesome-3.2.1/css/font-awesome.min.css">
	<link rel="stylesheet" type="text/css" href="./style/main2.css">
</head>
<body>
	<!-- top_bar -->
	<div class="top_bar">
		<div class="container_box">
			<span class="top_left">欢迎使用E购宝管理后台</span>
			<span class="top_right">
				<ul>
					<li class="qrcode_span">
						<a href="#"><img src="imgs/icon_qrcode.png">&nbsp;公众号</a>
						<div  class="EDS_qrcode"><img src="imgs/eds_qrcode.png" width="200"></div>
					</li>
					<li><a href="#"><img src="imgs/icon_baike.png">&nbsp;EDS百科</a></li>
					<li class="kefu_span">
						<a href="#"><img src="imgs/icon_kefu.png">&nbsp;联系客服 <img src="imgs/icon_arrow.png" class="kefu_arrow"></a>
						<div class="kefu_box">
							<div class="kefu_box_list">
								<img src="imgs/service_qrcode_zxh.png" class="left">
								<div class="left">
									<p>姓名：周小欢</p>
									<p>手机:18813399491</p>
									<p>微信:18813399491</p>
								</div>
							</div>
							<div class="underline"></div>
							<div class="kefu_box_list">
								<img src="imgs/service_qrcode_fyh.png" class="left">
								<div class="left">
									<p>姓名：周小欢</p>
									<p>手机:18813399491</p>
									<p>微信:18813399491</p>
								</div>
							</div>
							<div class="underline"></div>
							<div class="kefu_box_list">
								<img src="imgs/service_qrcode_wm.png" class="left">
								<div class="left">
									<p>姓名：周小欢</p>
									<p>手机:18813399491</p>
									<p>微信:18813399491</p>
								</div>
							</div>
							
						
						</div>
					</li>
					<li class="user_span">
						<a href="#"><img src="imgs/icon_user.png">&nbsp;<span class="username">用户名</span> <img src="imgs/icon_arrow.png" class="user_arrow"></a>
						<div class="user_box">
							<p><a href="#"><i class="icon-lock"></i>&nbsp;修改密码</a></p>
							<div class="underline"></div>
							<p><a href="#"><i class="icon-off"></i>&nbsp;退出</a></p>

						</div>
					</li>
				</ul>

				<!-- hover-block -->
				
			</span>
		</div>
	</div>
	<!-- top_bar END -->

	<!-- head_bar -->
	<div class="head_bar">
		<div class="container_box">
			<span class="head_left">
				<img src="imgs/egb_logo.png">
				<span class="title">客户终端管理后台</span>
			</span>
			<span class="head_right"></span>
		</div>
	</div>
	<!-- head_bar END -->

	<!-- body_content -->
	<div class="body_content">
		<div class="container_box">
			<div class="content_top">
				<form action="" method="POST" id="machineForm">
					<label>机器名称：</label>
					<input type="text" name="machineName" id="machineName">
					<input type="button" value="查询" class="btn_search" onclick="search()">
					<span class="tips">提醒：E购宝返回到window桌面默认密码为888888</span>
				</form>
			</div>
			<div class="content_table">
				<table cellpadding="0" cellspacing="0" >
					<thead>
					<tr class="t_head">
						<th>序号</th>
						<th>机器名称</th>
						<th>邀请码</th>
						<th>区域地址</th>
						<th>运营场所</th>
						<th>机器编码</th>
						<th>操作</th>
					</tr>
					</thead>
					<tbody></tbody>
				</table>
			</div>
			<div class="pagination">
				<span class="firstPage"><img src="imgs/first_page_btn.jpg" onclick="first_last(1)"></span>
				<span class="prePage"><img src="imgs/pre_page_btn.jpg" onclick="pre_next(-1)"></span>
				<span>第<span class="pageNumber"></span>页/共<span class="totalPages"></span>页<span>
				<span class="nextPage"><img src="imgs/next_page_btn.jpg" onclick="pre_next(1)"></span>
				<span class="lastPage"><img src="imgs/last_page_btn.jpg" onclick="first_last(totalPages)"></span>

			</div>
		</div>
	</div>
	<!-- body_content END -->

	<!-- copyRight -->
	<div class="copyRight">
		<div class="container_box">
			<ul>
				<li>EDS会员商城</li>
				<li>www.edsmall.cn</li>
				<li>免费热线4006-621-721</li>
				<li>咨询QQ：4006-621-721</li>
				<li>EDS百科</li>
				<li>粤ICP备14009360号</li>
			</ul>
		</div>
	</div>
	<!-- copyRight End-->

	<script type="text/javascript" src="./js/jquery-2.1.4.min.js"></script>
	<script type="text/javascript">
	$(function(){
		pageNum=1;
		totalPages=0;
		machineName = "";
		initPage();
		loadData();
	})


	// 页面初始化
	function initPage(){
		// $('.content_table tr:last').find('td').css("border-bottom","#ccc");
		// $('.content_table tr').find('td:last').css("border-right","#ccc"); 

		$('.qrcode_span').hover(function(){
			$('.EDS_qrcode').css('display','inline-block');
		},function(){
			$('.EDS_qrcode').css('display','none');
		});

		$('.kefu_span').hover(function(){
			$('.kefu_box').css('display','inline-block');
			$('.kefu_arrow').css('transform','rotate(180deg)');
		},function(){
			$('.kefu_box').css('display','none');
			$('.kefu_arrow').css('transform','rotate(0deg)');
		});

		$('.user_span').hover(function(){
			$('.user_box').css('display','inline-block');
			$('.user_arrow').css('transform','rotate(180deg)');
		},function(){
			$('.user_box').css('display','none');
			$('.user_arrow').css('transform','rotate(0deg)');
		});
		$('.username').html(localStorage.getItem('username'));
	}

	// 页码判断
	function page(){
		if(pageNum == 1){
			$('.firstPage').css('display','none');
			$('.prePage').css('display','none');
		}
		if(pageNum != totalPages){
			$('.nextPage').css('display','inline-block');
			$('.lastPage').css('display','inline-block');
		}
	}

	// 加载列表数据
	function loadData(){
		$.ajax({
			url:"/machines",
			method:"get",
			dataType:'json',
			data:{
				'pageNumber':pageNum,
				'machineName':machineName,
				'pageSize':'30',
			},
			success:function(result){
				// 列表数据
				totalPages = result['data']['totalPages'];
				var list = result['data']['list'];
				var list_length = list.length;
				for(var i=0;i<list_length;i++){
					list[i]['machineName'] = list[i]['machineName'] || "";
					list[i]['machineAddr'] = list[i]['machineAddr'] || "";
					list[i]['machineWorkArea'] = list[i]['machineWorkArea'] || "";
					var workArea = list[i]['machineWorkArea'].split(',');
					for(var j = 0;j<workArea.length;j++){
						switch(workArea[j]){
							case "0": workArea[j]="其他"; break;
							case "1": workArea[j]="门店"; break;
							case "2": workArea[j]="售楼部";break;
							case "3": workArea[j]="小区"; break;
							case "4": workArea[j]="合作联盟"; break;
							case "5": workArea[j]="商城"; break;
							case "6": workArea[j]="活动现场"; break;
							case "7": workArea[j]="市场门槛"; break;
						};		
						list[i]['machineWorkArea'] = workArea.join(',');			
					}
				
					$('.content_table table tbody').append(
						"<tr><td>"+(i+1)+"</td><td>"+list[i]['machineName']+"</td><td>"+list[i]['invitationCode']+"</td><td>"+list[i]['machineAddr']+"</td><td>"+list[i]['machineWorkArea']+"</td><td>"+list[i]['machineNo']+"</td><td><a href='#' class='oper'>机器管理</a></td></tr>"
					);
				}
				// 页码
				$('.pageNumber').html(result['data']['pageNumber']);
				$('.totalPages').html(result['data']['totalPages']);
			},
			
		});
	}
	// ajax End
	// 查询
	function search(){
		var str1 = $('#machineName').val();
		var str2 = $.trim(str1);
		machineName = str2;
		$('.content_table table tbody').html('');
		loadData();
	}


	// 页码
	function first_last(page){
		pageNum = page;
		$('.content_table table tbody').html('');
		loadData();
	}
	function pre_next(num){
		pageNum = pageNum + num;
		$('.content_table table tbody').html('');
		loadData();
	}	
	</script>
</body>
</html>
